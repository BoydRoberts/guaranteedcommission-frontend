<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Upgrade Options</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">

  <div class="max-w-xl mx-auto mt-20 bg-white p-6 rounded shadow text-center">
    <h1 class="text-2xl font-bold mb-6">Upgrade Your Listing</h1>

    <h2 id="upsellTitle" class="text-lg font-semibold mb-4"></h2>
    <p id="upsellDescription" class="text-sm text-gray-700 mb-6"></p>

    <div class="flex justify-center gap-4">
      <button onclick="acceptUpsell()" class="bg-green-600 text-white px-6 py-2 rounded">Yes</button>
      <button onclick="skipUpsell()" class="bg-gray-400 text-white px-6 py-2 rounded">Skip</button>
    </div>
  </div>

  <script>
    const plan = localStorage.getItem("selectedPlan") || "";
    const upsells = [];

    // Build upsell list based on plan type
    if (plan === "Listed Property Basic") {
      upsells.push(
        { key: "upgradeToPlus", title: "Upgrade to Listed Property Plus ($20)", desc: "Add 20 photos and a full property description to your listing." },
        { key: "banner", title: "Add Banner ($10)", desc: "Add a 30-character banner to highlight special features or promotions." },
        { key: "premium", title: "Add Premium Placement ($10)", desc: "Appear before non-premium listings in your search area." },
        { key: "pin", title: "Add Pin Placement ($50)", desc: "Pinned at the top of results. Includes Premium Placement for free." }
      );
    } else if (plan === "Listed Property Plus") {
      upsells.push(
        { key: "banner", title: "Add Banner ($10)", desc: "Add a 30-character banner to highlight special features or promotions." },
        { key: "premium", title: "Add Premium Placement ($10)", desc: "Appear before non-premium listings in your search area." },
        { key: "pin", title: "Add Pin Placement ($50)", desc: "Pinned at the top of results. Includes Premium Placement for free." }
      );
    } else if (plan === "FSBO Plus") {
      upsells.push(
        { key: "confidential", title: "Confidential FSBO Upgrade ($100)", desc: "Keep your contact info private and avoid solicitations." },
        { key: "banner", title: "Add Banner ($10)", desc: "Add a 30-character banner to highlight special features or promotions." },
        { key: "premium", title: "Add Premium Placement ($10)", desc: "Appear before non-premium listings in your search area." },
        { key: "pin", title: "Add Pin Placement ($50)", desc: "Pinned at the top of results. Includes Premium Placement for free." }
      );
    }

    let currentIndex = 0;

    function showUpsell() {
      // Skip any upsell already purchased
      while (currentIndex < upsells.length && localStorage.getItem(upsells[currentIndex].key) === "true") {
        currentIndex++;
      }

      // If no more upsells, go to checkout
      if (currentIndex >= upsells.length) {
        window.location.href = "/checkout.html";
        return;
      }

      const currentUpsell = upsells[currentIndex];
      document.getElementById("upsellTitle").textContent = currentUpsell.title;
      document.getElementById("upsellDescription").textContent = currentUpsell.desc;
    }

    function acceptUpsell() {
      const currentUpsell = upsells[currentIndex];
      localStorage.setItem(currentUpsell.key, "true");

      // Pin Placement auto-includes Premium
      if (currentUpsell.key === "pin") {
        localStorage.setItem("premium", "true");
      }

      currentIndex++;
      showUpsell();
    }

    function skipUpsell() {
      currentIndex++;
      showUpsell();
    }

    window.addEventListener("DOMContentLoaded", showUpsell);
  </script>

</body>
</html>
