<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sign ISC</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">

  <div class="max-w-3xl mx-auto mt-10 bg-white p-6 rounded shadow">
    <h1 class="text-2xl font-bold text-center mb-6">Electronic Signature</h1>

    <div class="text-sm text-justify space-y-4 leading-relaxed">
      <p>To the escrow holder/closing agent,</p>
      <p>
        I, <span id="letterName">[name]</span>, am the owner/seller of
        <span id="letterAddressFull">[full address]</span>, #<span id="letterAPN">[APN]</span>.
        <span id="letterAddressShort1">[short address]</span> is listed for sale by
        <span id="letterBrokerage">[listing brokerage]</span>,
        <span id="letterAgent">[listing agent]</span>, listing agent,
        <span id="letterAgentPhone">[agent phone]</span>.
      </p>
      <p>
        Let it be known: if a buyer’s agent/broker facilitates the sale of
        <span id="letterAddressShort2">[short address]</span>, you (the escrow holder/closing agent)
        are irrevocably instructed to credit/compensate the buyer’s broker a commission not to exceed
        <span id="letterCommissionDisplay">[commission]</span>
        <span id="commissionSuffix"></span>.
      </p>
    </div>

    <div class="mt-8">
      <label for="signature" class="block text-sm font-medium mb-1">Electronic Signature</label>
      <input type="text" id="signature" placeholder="Your Full Name" class="w-full border p-2 rounded" />
    </div>

    <p class="mt-4 text-sm text-gray-600">
      Date: <span id="todayDate"></span>
    </p>

    <div class="mt-6 text-center">
      <button onclick="submitSignature()" class="bg-green-600 text-white px-6 py-2 rounded">
        Sign & Finish
      </button>
    </div>
  </div>

  <script>
    // Fill ISC from localStorage data
    const data = JSON.parse(localStorage.getItem("formData") || "{}");
    const commissionDisplay = data.commissionType === "$"
      ? `$${data.commission}` : `${data.commission}%`;
    const suffix = data.commissionType === "%" ? "of the total purchase price." : "";

    const shortAddr = data.address ? data.address.split(",")[0] : "";

    document.getElementById("letterName").textContent = data.name || "[name]";
    document.getElementById("letterAddressFull").textContent = data.address || "[full address]";
    document.getElementById("letterAddressShort1").textContent = shortAddr || "[short address]";
    document.getElementById("letterAddressShort2").textContent = shortAddr || "[short address]";
    document.getElementById("letterAPN").textContent = data.apn || "[APN]";
    document.getElementById("letterBrokerage").textContent = data.brokerage || "[listing brokerage]";
    document.getElementById("letterAgent").textContent = data.agent || "[listing agent]";
    document.getElementById("letterAgentPhone").textContent = data.phone || "[agent phone]";
    document.getElementById("letterCommissionDisplay").textContent = commissionDisplay;
    document.getElementById("commissionSuffix").textContent = suffix;

    // Show today's date
    document.getElementById("todayDate").textContent = new Date().toLocaleDateString();

 function submitSignature() {
  const sig = document.getElementById("signature").value.trim();
  if (!sig) {
    alert("Please type your name to sign.");
    return;
  }

  const shortAddress = document.getElementById("letterAddressShort1").textContent || "[short address]";

  const message = `You have successfully signed the Irrevocable Seller Communication (ISC) for ${shortAddress}.\n\nClick OK to view your signed ISC now.`;

  alert(message);
  window.location.href = "/submit.html";
}
   function submitSignature() {
  const sig = document.getElementById("signature").value.trim();
  if (!sig) {
    alert("Please type your name to sign.");
    return;
  }

  const shortAddress = document.getElementById("letterAddressShort1").textContent || "[short address]";

  const message = `
    You have successfully signed the Irrevocable Seller Communication (ISC) for ${shortAddress}.\n\n
    Click OK to view your signed ISC now.
  `;

  if (confirm(message)) {
    window.location.href = "/submit.html";
        }

      alert("Thank you. Your ISC has been signed and saved.");
      // You can redirect or clear data here
      window.location.href = "/submit.html"; // optional "Thank you" page
    function submitSignature() {
      const sig = document.getElementById("signature").value.trim();
      if (!sig) {
        alert("Please type your name to sign.");
        return;
      }

      const shortAddress = document.getElementById("letterAddressShort1").textContent || "[short address]";
      const message = `You have successfully signed the Irrevocable Seller Communication (ISC) for ${shortAddress}.\n\nClick OK to view your signed ISC now.`;

      alert(message);
      window.location.href = "/submit.html";
    }
  </script>

</body>
</html>
