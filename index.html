<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GuaranteedCommission.com</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .font-cursive { font-family: 'Brush Script MT', cursive; }
    .group:hover #commissionMenu,
    .group:focus-within #commissionMenu {
      display: block;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">

<!-- Header -->
<header class="bg-white shadow">
  <div class="flex justify-between items-center max-w-7xl mx-auto px-4 py-4">
    <button onclick="openInvestorModal()" class="bg-red-600 text-white text-xs font-semibold px-3 py-1 rounded">
      Accredited Investors Only
    </button>
    <div class="text-center flex-1">
      <h1 class="text-3xl font-bold">GuaranteedCommission.com</h1>
      <p class="text-sm text-red-600 mt-1 px-2">
        Guaranteeing buyer agent’s commissions so your home will sell quickly at a higher price.
      </p>
    </div>
    <button onclick="openPressModal()" class="bg-blue-600 text-white text-xs font-semibold px-3 py-1 rounded">
      Press Inquiry
    </button>
  </div>
</header>

<!-- Investor Modal -->
<div id="investorModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 w-96 relative">
    <button onclick="closeInvestorModal()" class="absolute top-2 right-2 text-xl font-bold">&times;</button>
    <h2 class="text-lg font-bold mb-4">Accredited Investor Certification</h2>
    <label class="block mb-2"><input type="checkbox"> Net worth exceeds $1M</label>
    <label class="block mb-2"><input type="checkbox"> Annual income exceeds $200K</label>
    <input type="text" id="investorName" placeholder="Full Name" class="w-full border p-1 mb-2 rounded">
    <input type="tel" id="investorPhone" placeholder="Phone Number" class="w-full border p-1 mb-2 rounded">
    <input type="email" id="investorEmail" placeholder="Email Address" class="w-full border p-1 mb-4 rounded">
    <button onclick="submitInvestorForm()" class="w-full bg-blue-600 text-white py-2 rounded">Submit</button>
    <p id="investorConfirmation" class="mt-4 text-green-600 font-semibold text-center hidden">We will be in touch.</p>
  </div>
</div>

<!-- Press Inquiry Modal -->
<div id="pressModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 w-96 relative">
    <button onclick="closePressModal()" class="absolute top-2 right-2 text-xl font-bold">&times;</button>
    <h2 class="text-lg font-bold mb-4">Press Inquiry Form</h2>
    <input type="text" id="pressName" placeholder="Full Name" class="w-full border p-1 mb-2 rounded">
    <input type="text" id="pressOrg" placeholder="Organization" class="w-full border p-1 mb-2 rounded">
    <input type="tel" id="pressPhone" placeholder="Phone Number" class="w-full border p-1 mb-2 rounded">
    <input type="email" id="pressEmail" placeholder="Email Address" class="w-full border p-1 mb-4 rounded">
    <button onclick="submitPressForm()" class="w-full bg-blue-600 text-white py-2 rounded">Submit</button>
    <p id="pressConfirmation" class="mt-4 text-green-600 font-semibold text-center hidden">We will be in touch.</p>
  </div>
</div>

<!-- Navigation -->
<nav class="bg-gray-200 py-2">
  <ul class="flex justify-center space-x-8 font-semibold">
    <li class="relative group">
      <span class="hover:underline cursor-pointer">Communicate Guaranteed Commission</span>
      <ul id="commissionMenu" class="absolute left-0 mt-2 w-64 bg-white border shadow text-sm text-gray-700 z-10 hidden">
        <li><a href="#" onclick="showForm('listed')" class="block px-4 py-2 hover:bg-gray-100">Listed Property Basic</a></li>
        <li><a href="#" onclick="showForm('plus')" class="block px-4 py-2 hover:bg-gray-100">Listed Property Plus</a></li>
        <li><a href="#" onclick="showForm('fsbo')" class="block px-4 py-2 hover:bg-gray-100">FSBO Plus</a></li>
      </ul>
    </li>
    <li><a href="#strip2Search" class="hover:underline">Search Guaranteed Commission</a></li>
    <li><a href="/login.html" class="hover:underline">Log In</a></li>
  </ul>
</nav>

<!-- Strip 1 -->
<section class="flex flex-col md:flex-row justify-center items-start gap-6 px-4 py-8 max-w-7xl mx-auto">
  <!-- Box 1 -->
  <div class="w-full md:w-1/3 bg-white p-4 rounded shadow text-sm">
    <h2 class="text-lg font-bold mb-4 text-center">Commission Communication Menu</h2>
    <ul class="space-y-3">
      <li>
        <div onclick="selectPlan('Listed Property Basic')" class="cursor-pointer">
          <p class="text-base font-semibold">Listed Property Basic | <span class="text-red-600">FREE</span></p>
          <p class="text-gray-600 pl-5">Printable commission letter, map search, listing price, main photo, address, square footage, bedrooms, bathrooms, listing brokerage, listing agent, listing agent phone number.</p>
        </div>
      </li>
      <li>
        <div onclick="selectPlan('Listed Property Plus')" class="cursor-pointer">
          <p class="text-base font-semibold">Listed Property Plus | $20</p>
          <p class="text-gray-600 pl-5">Listed Property Basic plus 20 photos and full property description.</p>
        </div>
      </li>
      <li>
        <div onclick="selectPlan('FSBO Plus')" class="cursor-pointer">
          <p class="text-base font-semibold">FSBO Plus | $100</p>
          <p class="text-gray-600 pl-5">Listed Property Plus minus the listing agency. Includes showing instructions.</p>
        </div>
      </li>
    </ul>
  </div>

  <!-- Box 2 -->
  <div id="formBlock" class="w-full md:w-1/3 bg-white p-4 rounded shadow text-sm">
    <h2 class="text-lg font-bold mb-4 text-center">Listed Property Communication Form</h2>
    <!-- form fields -->
  </div>

  <!-- Box 3 -->
  <div class="w-full md:w-1/3 bg-white p-4 rounded shadow text-sm text-justify">
    <h2 class="text-lg font-bold mb-2 text-center">Irrevocable Seller Communication</h2>
    <!-- ISC content -->
  </div>
</section>

<!-- Strip 2 -->
<section id="strip2Search" class="max-w-7xl mx-auto px-4 py-8">
  <div class="flex items-end justify-between mb-4">
    <div>
      <h2 class="text-2xl font-bold">Search Guaranteed Commission</h2>
      <p class="text-sm text-gray-600">Listings that clearly communicate buyer’s agent commission.</p>
    </div>
    <div class="hidden md:block">
      <a href="/login.html" class="text-sm text-blue-600 hover:underline">Log in</a>
    </div>
  </div>

  <div class="bg-white border rounded p-3 mb-6">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
      <input id="s2Location" class="border p-2 rounded" placeholder="City, neighborhood, ZIP">
      <input id="s2MinPrice" class="border p-2 rounded" placeholder="Min price ($)">
      <input id="s2MaxPrice" class="border p-2 rounded" placeholder="Max price ($)">
    </div>
    <div class="mt-3 flex items-center gap-2">
      <button id="s2SearchBtn" class="bg-blue-600 text-white px-4 py-2 rounded text-sm">Search</button>
      <span class="text-xs text-gray-500">Search is visual only right now. We’ll hook data shortly.</span>
    </div>
  </div>

  <div id="listingsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>

  <div id="listingsEmpty" class="hidden text-sm text-gray-600 bg-white border rounded p-4">
    No listings yet. Once a seller/agent completes details, listings will appear here.
  </div>

  <style>
    .gc-tile { border-radius: 0.75rem; overflow: hidden; background: #fff; box-shadow: 0 1px 2px rgba(0,0,0,0.06); }
    .gc-img { width: 100%; height: 14rem; object-fit: cover; background: #e5e7eb; }
    .gc-badge {
      position: absolute; top: 10px; left: 10px;
      background: rgba(0,0,0,0.65); color: #fff;
      padding: 4px 8px; font-size: 12px; border-radius: 6px;
    }
    .gc-ribbon {
      position: absolute; top: 10px; right: -10px;
      background: #2563eb; color: #fff; padding: 6px 12px;
      transform: rotate(10deg); border-radius: 6px;
      font-size: 12px; max-width: 160px; text-overflow: ellipsis; white-space: nowrap; overflow: hidden;
    }
  </style>
</section>

<!-- Scripts -->
<script>
  // Existing index.html scripts...
</script>

<script>
(function wireStrip2(){
  const grid = document.getElementById("listingsGrid");
  const empty = document.getElementById("listingsEmpty");

  const formData = JSON.parse(localStorage.getItem("formData") || "{}");
  const agentListing = JSON.parse(localStorage.getItem("agentListing") || "{}");
  const plan = (localStorage.getItem("selectedPlan") || "Listed Property Basic").trim();

  const listing = (() => {
    if (!formData.address) return null;
    const fullAddress = formData.address;
    const shortAddress = fullAddress.split(",")[0] || fullAddress;
    const price = agentListing.price ?? "";
    const commission = agentListing.commission ?? (formData.commission || "");
    const commissionType = agentListing.commissionType ?? (formData.commissionType || "%");
    const bannerText = (agentListing.bannerText || "").trim();
    const photos = Array.isArray(agentListing.photos) ? agentListing.photos : [];
    const primaryIndex = (typeof agentListing.primaryIndex === "number" ? agentListing.primaryIndex : 0);

    return {
      plan,
      fullAddress,
      shortAddress,
      price,
      commission,
      commissionType,
      bannerText,
      photo: (photos[primaryIndex] || null)
    };
  })();

  const fmtPrice = (v) => {
    const n = Number(v || 0);
    if (!n) return "$—";
    return "$" + n.toLocaleString();
  };

  const commissionBadge = (price, comm, type) => {
    const p = Number(price || 0);
    const c = Number(comm || 0);
    if (!c) return "";
    if (type === "$") return `Commission: $${Math.round(c).toLocaleString()}`;
    const amt = Math.round(p * (c/100));
    return `Commission: ${c}%${p ? ` (~$${amt.toLocaleString()})` : ""}`;
  };

  const makeTile = (item) => {
    const card = document.createElement("a");
    card.href = "/agent-preview.html";
    card.className = "gc-tile block hover:shadow-md transition";

    const wrap = document.createElement("div");
    wrap.className = "relative";

    const img = document.createElement("img");
    img.className = "gc-img";
    img.alt = "Listing main photo";
    img.src = item.photo || "";
    wrap.appendChild(img);

    const badgeText = commissionBadge(item.price, item.commission, item.commissionType);
    if (badgeText) {
      const badge = document.createElement("div");
      badge.className = "gc-badge";
      badge.textContent = badgeText;
      wrap.appendChild(badge);
    }

    if (item.bannerText) {
      const ribbon = document.createElement("div");
      ribbon.className = "gc-ribbon";
      ribbon.textContent = item.bannerText;
      wrap.appendChild(ribbon);
    }

    const body = document.createElement("div");
    body.className = "p-4";
    body.innerHTML = `
      <div class="text-xl font-semibold">${fmtPrice(item.price)}</div>
      <div class="text-gray-700">${item.shortAddress || ""}</div>
      <div class="text-sm text-gray-500 mt-1">${item.fullAddress || ""}</div>
    `;

    card.appendChild(wrap);
    card.appendChild(body);
    return card;
  };

  grid.innerHTML = "";
  if (listing) {
    grid.appendChild(makeTile(listing));
    empty.classList.add("hidden");
  } else {
    empty.classList.remove("hidden");
  }

  const sBtn = document.getElementById("s2SearchBtn");
  if (sBtn) {
    sBtn.addEventListener("click", () => {
      alert("Search UI is a visual stub for now. We'll hook this to data once Firestore is live.");
    });
  }
})();
</script>
</body>
</html>
